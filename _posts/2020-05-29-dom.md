---
layout: post
title: "DOM的学习"
subtitle: "本来打算学完es6就认真去学框架的,但又觉得还是有必要去学习一下DOM"
date: 2019-08-19 22:12:08
author: "Aurora"
tags: javascript
---

## DOM

HTML 文档的主干是标签（tag）。

根据文档对象模型（DOM），每个 HTML 标签都是一个对象。嵌套的标签是闭合标签的“子标签（children）”。标签内的文本也是一个对象。

- 标签被称为 元素节点（或者仅仅是元素）
- 元素内的文本形成 文本节点
- 注释也会作为 comment node 树节点类型,HTML 中的所有内容，甚至注释，都会成为 DOM 的一部分

### 顶层节点

最顶层的树节点可以直接作为 document 的属性来使用：  
`<html> = document.documentElement`

最顶层的 document 节点是 document.documentElement。这是对应 `<html>` 标签的 DOM 节点。
另一个被广泛使用的 DOM 节点是 `<body>` 元素 — document.body。  
`<body> = document.body`

`<head>` 标签可以通过 document.head 访问。  
`<head> = document.head`

### node 相关

- childNodes:返回一个节点(直到脚本运行时)所有的的子节点,返回一个类数组对象可迭代对象
- parentNode:返回一个节点的父节点
- firstChild:返回一个节点的第一个节点
- lastChild:返回一个节点的最后一个节点
- nextSibling:返回该节点下一个同级的元素
- previousSibling:返回该节点上一个同级的元素
- tagName:所选元素的标签名

### Element

- children:返回该节点的所有子元素
- firstElementChild，lastElementChild:第一个和最后一个子元素
- previousElementSibling，nextElementSibling:兄弟元素。
- parentElement:父元素
- nodeName:所选节点的标签名

### extra

- hidden:当被设置为 true 时，执行与 CSS display:none 相同的事。

#### table

- table.rows — \<tr> 元素的集合。
- table.caption/tHead/tFoot — 引用元素 \<caption>，\<thead>，\<tfoot>。
- table.tBodies — \<tbody> 元素的集合（根据标准还有很多元素，但是这里至少会有一个 — 即使没有被写在 HTML 源文件中，浏览器也会将其放入 DOM 中）。
- tbody.rows — 表格内部 \<tr> 元素的集合。
- tr.cells — 在给定 \<tr> 中的 \<td> 和 \<th> 单元格的集合。
- tr.sectionRowIndex — 给定的 \<tr> 在封闭的 \<thead>/\<tbody>/\<tfoot> 中的位置（索引）。
- tr.rowIndex — 在整个表格中 \<tr> 的编号（包括表格的所有行）。
- td/th.cellIndex — 在封闭的 <tr> 中单元格的编号。

### 查找元素

- document.getElementById:返回给定 ID 的实时动态的元素
- elem.querySelectorAll:根基选择器返回静态的元素集合
- elem.querySelector:根基选择器返回静态的元素
- elem.matches(css) 用于检查 elem 与给定的 CSS 选择器是否匹配。(返回 true/false)
- elem.closest(css) 用于查找与给定 CSS 选择器相匹配的最近的祖先。elem 本身也会被检查。(返回找到元素)
- getElementsByName,getElementsByTagName,getElementsByClassName:大多已经成为了历史，因为 querySelector 功能更强大，写起来更短
  > 只有 document.getElementById，没有 anyElem.getElementById

### DOM 节点 class

每个 DOM 节点都属于相应的内建类。

层次结构（hierarchy）的根节点是 EventTarget，Node 继承自 EventTarget，其他 DOM 节点继承自 Node。

![示意图]({{ site.url }}/img/dom/dom-class-hierarchy.svg)

- EventTarget — 是根的“抽象（abstract）”类。该类的对象从未被创建。它作为一个基础，以便让所有 DOM 节点都支持所谓的“事件（event）”，我们会在之后学习它。
- Node — 也是一个“抽象”类，充当 DOM 节点的基础。它提供了树的核心功能：parentNode，nextSibling，childNodes 等（它们都是 getter）。Node 类的对象从未被创建。但是有一些继承自它的具体的节点类，例如：文本节点的 Text，元素节点的 Element，以及更多异域（exotic）类，例如注释节点的 Comment。
- Element — 是 DOM 元素的基本类。它提供了元素级的导航（navigation），例如 nextElementSibling，children，以及像 getElementsByTagName 和 querySelector 这样的搜索方法。浏览器中不仅有 HTML，还会有 XML 和 SVG。Element 类充当更多特定类的基本类：SVGElement，XMLElement 和 HTMLElement。
- HTMLElement — 最终是所有 HTML 元素的基本类。各种 HTML 元素均继承自它：
- 1. HTMLInputElement — \<input> 元素的类，
- 2. HTMLBodyElement — \<body> 元素的类，
- 3. HTMLAnchorElement — \<a> 元素的类，……等，每个标签都有自己的类，这些类可以提供特定的属性和方法。

因此，给定节点的全部属性和方法都是继承的结果。

### “nodeType” 属性

nodeType 属性提供了另一种“过时的”用来获取 DOM 节点类型的方法。

它有一个数值型值（numeric value）：

- 对于元素节点 elem.nodeType == 1，
- 对于文本节点 elem.nodeType == 3，
- 对于 document 对象 elem.nodeType == 9，
- 在 规范 中还有一些其他值。

### 内容读写

#### innerHTML

innerHTML 属性允许将元素中的 HTML 获取为字符串形式,我们也可以修改它(可以拆入 html 语句,会自动转化)。

#### outerHTML

与 innerHTML 不同，写入 outerHTML 不会改变元素。而是在 DOM 中替换它(?)

#### nodeValue/data

innerHTML 属性仅对元素节点有效。

其他节点类型，例如文本节点，具有它们的对应项：nodeValue 和 data 属性。这两者在实际使用中几乎相同，只有细微规范上的差异。因此，我们将使用 data，因为它更短。

#### textContent

textContent 提供了对元素内的 文本 的读写权限：仅文本，去掉所有 <tags>。

> 写入 textContent 要有用得多，因为它允许以“安全方式”写入文本。

### 特性和属性

教程中为了区分 html 与 dom 的属性,故称 html 中的属性为特性,dom 中为属性

#### HTML 特性

在 HTML 中，标签可能拥有特性（attributes）。当浏览器解析 HTML 文本，并根据标签创建 DOM 对象时，浏览器会辨别 标准的 特性并以此创建 DOM 属性。

所以，当一个元素有 id 或其他 标准的 特性，那么就会生成对应的 DOM 属性。但是非 标准的 特性则不会。

所有特性都可以通过使用以下方法进行访问：

- elem.hasAttribute(name) — 检查特性是否存在。
- elem.getAttribute(name) — 获取这个特性值。
- elem.setAttribute(name, value) — 设置这个特性值。
- elem.removeAttribute(name) — 移除这个特性。
- elem.attributes - 读取所有特性,属于内建 Attr 类的对象的集合，具有 name 和 value 属性。

HTML 特性有以下几个特征：

- 它们的名字是大小写不敏感的（id 与 ID 相同）。
- 它们的值总是字符串类型的。

##### 非标准的特性，dataset

所有以 “data-” 开头的特性均被保留供程序员使用。它们可在 dataset 属性中使用

像 data-order-state 这样的多词特性可以以驼峰式进行调用：dataset.orderState

使用 data-\* 特性是一种合法且安全的传递自定义数据的方式

#### 属性—特性同步

当一个标准的特性被改变，对应的属性也会自动更新，（除了几个特例）反之亦然。

但也有些例外，例如 input.value 只能从特性同步到属性，反过来则不行

#### DOM 属性

DOM 属性不总是字符串类型的。例如，input.checked 属性（对于 checkbox 的）是布尔型的,还有其他的例子。style 特性是字符串类型的，但 style 属性是一个对象
